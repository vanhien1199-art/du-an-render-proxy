<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i 17: L·ª±c ƒë·∫©y Archimedes</title>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <script>
        window.lessonId = 'luc-day-archimedes';
        document.addEventListener('DOMContentLoaded', () => {
            const chatWindow = document.getElementById('chat-window');
            const userInput = document.getElementById('user-input');
            const sendButton = document.getElementById('send-button');
            const AI_SERVICE_URL = 'https://ai-trung-tam-service.onrender.com';
            const LESSON_ID = window.lessonId || 'default';
            if(sendButton){
                sendButton.addEventListener('click', askAI);
                userInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') askAI(); });
            }
            function addMessageToChat(text, className) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('chat-message', className);
                chatWindow.appendChild(messageElement);
                messageElement.innerHTML = marked.parse(text);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                return messageElement;
            }
            async function askAI() {
                const question = userInput.value.trim();
                if (!question) return;
                addMessageToChat(question, 'user-message');
                userInput.value = '';
                const waitingMessage = addMessageToChat('Tr·ª£ l√Ω AI ƒëang suy nghƒ©...', 'ai-message');
                try {
                    const response = await fetch(`${AI_SERVICE_URL}/ask`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ question: question, lesson_id: LESSON_ID })
                    });
                    if (!response.ok) throw new Error('L·ªói m·∫°ng ho·∫∑c server');
                    const data = await response.json();
                    waitingMessage.innerHTML = marked.parse(data.answer);
                } catch (error) {
                    waitingMessage.innerHTML = marked.parse('**Xin l·ªói, ƒë√£ c√≥ l·ªói x·∫£y ra!**');
                }
            }
        });
    </script>

    <style>
        :root {
            --primary-color: #007bff; /* Xanh d∆∞∆°ng */
            --secondary-color: #17a2b8; /* Xanh l∆° */
            --bg-color: #f8f9fa;
            --card-bg-color: #ffffff;
            --text-color: #343a40;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.7; background-color: var(--bg-color); color: var(--text-color); margin: 0; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        header { background: linear-gradient(90deg, var(--primary-color), var(--secondary-color)); color: white; padding: 1.5rem 1rem; text-align: center; margin-bottom: 30px; position: relative; }
        header h1 { margin: 0; font-size: 2.5em; }
        .card { background-color: var(--card-bg-color); border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); padding: 30px; margin-bottom: 30px; }
        h2, h3, h4 { color: var(--primary-color); }
        h2 { border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px; margin-top: 0; }
        button { background-color: var(--secondary-color); color: white; border: none; padding: 10px 20px; font-size: 1em; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; }
        button:hover { background-color: #138496; }
        input[type="number"] { padding: 8px; border-radius: 5px; border: 1px solid #ccc; margin: 0 5px; }
        
        .home-btn { position: absolute; top: 50%; left: 20px; transform: translateY(-50%); font-size: 28px; color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s, transform 0.3s; }
        .home-btn:hover { opacity: 1; transform: translateY(-50%) scale(1.1); }

        /* Ph·∫ßn I: PhET */
        .phet-instructions { background-color: #e7f5ff; padding: 20px; border-left: 5px solid var(--primary-color); border-radius: 5px; }
        .phet-container { border: 2px solid var(--primary-color); border-radius: 8px; overflow: hidden; margin-top: 20px; }
        .phet-container iframe { display: block; border: none; }
        
        /* Ph·∫ßn II: Tr√≤ ch∆°i Ch√¨m/N·ªïi */
        .buoyancy-game { text-align: center; }
        .game-animation { position: relative; height: 200px; background-color: #e0f7fa; border: 2px solid var(--secondary-color); border-radius: 8px; margin: 20px 0; overflow: hidden; }
        .water-surface { position: absolute; bottom: 0; left: 0; width: 100%; height: 50%; background-color: #80deea; }
        #game-object { position: absolute; width: 60px; height: 60px; background-color: #a1887f; border: 2px solid #5d4037; top: 10%; left: calc(50% - 30px); }
        #game-object.sinking { animation: sink 2s forwards; }
        #game-object.floating { animation: float-up 2s forwards; }
        @keyframes sink { 0% { top: 10%; } 100% { top: 110%; } } /* Ch√¨m h·∫≥n xu·ªëng ƒë√°y */
        @keyframes float-up { 0% { top: 70%; } 100% { top: 40%; } } /* N·ªïi l√™n m·∫∑t n∆∞·ªõc */
        
        /* Ph·∫ßn IV: Luy·ªán t·∫≠p */
        .exercise-item { border-top: 1px solid #eee; padding-top: 20px; margin-top: 20px; }
        .feedback { margin-top: 10px; font-weight: bold; padding: 10px; border-radius: 5px; }
        .feedback.correct { color: #155724; background-color: #d4edda; }
        .feedback.incorrect { color: #721c24; background-color: #f8d7da; }
        .solution { display: none; margin-top: 10px; background-color: #f9f9f9; border-left: 3px solid var(--primary-color); padding: 10px; }

        /* CSS Chatbot, Footer, Back-to-Top */
        .chat-window { height: 300px; border: 1px solid #ccc; padding: 10px; overflow-y: auto; margin-bottom: 10px; }
        .chat-message { margin-bottom: 10px; } .user-message { text-align: right; }
        .ai-message { background-color: #f1f1f1; padding: 10px; border-radius: 8px; display: inline-block; max-width: 90%; text-align: left; }
        .chat-input-area { display: flex; gap: 10px; } .chat-input-area input { flex-grow: 1; }
        .site-footer { background-color: #333; color: #f1f1f1; padding: 30px 0; font-size: 0.9em; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .site-footer h4 { color: var(--secondary-color); } .site-footer ul { list-style-type: none; padding: 0; }
        .site-footer a { color: #f1f1f1; text-decoration: none; } .site-footer a:hover { color: var(--secondary-color); }
        #back-to-top-btn { display: none; position: fixed; bottom: 20px; right: 20px; z-index: 999; background-color: var(--secondary-color); color: white; cursor: pointer; padding: 10px; border-radius: 50%; font-size: 18px; width: 50px; height: 50px; text-align: center; line-height: 30px; text-decoration: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2); border: none;}
        #back-to-top-btn:hover { background-color: var(--primary-color); }
    </style>
</head>
<body id="page-top">
    <header>
        <a href="/" class="home-btn" title="V·ªÅ trang ch·ªß">üè†</a>
        <h1>B√†i 17: L·ª∞C ƒê·∫®Y ARCHIMEDES</h1>
    </header>

    <div class="container">
        <section id="phan1" class="card">
            <h2>Ph·∫ßn I: Th√≠ nghi·ªám ·∫£o v·ªõi PhET</h2>
            <div class="phet-instructions">
                <p>S·ª≠ d·ª•ng m√¥ ph·ªèng PhET, h√£y th·∫£ c√°c kh·ªëi v·∫≠t c√≥ ch·∫•t li·ªáu kh√°c nhau v√†o n∆∞·ªõc. Quan s√°t v√† so s√°nh ƒë·ªô l·ªõn c·ªßa l·ª±c ƒë·∫©y (F<sub>B</sub>) v√† tr·ªçng l∆∞·ª£ng c·ªßa v·∫≠t (F<sub>g</sub>) ƒë·ªÉ gi·∫£i th√≠ch t·∫°i sao v·∫≠t ch√¨m ho·∫∑c n·ªïi.</p>
            </div>
            <div class="phet-container">
                <iframe src="https://phet.colorado.edu/sims/html/buoyancy/latest/buoyancy_vi.html" width="100%" height="500px" allowfullscreen></iframe>
            </div>
        </section>

        <section id="phan2" class="card">
            <h2>Ph·∫ßn II: Tr√≤ ch∆°i t∆∞∆°ng t√°c "Ch√¨m hay N·ªïi?"</h2>
            <div class="buoyancy-game">
                <p><strong>T√¨nh hu·ªëng:</strong> M·ªôt kh·ªëi g·ªó c√≥ tr·ªçng l∆∞·ª£ng <strong>P = 8N</strong>. Nh√∫ng ch√¨m ho√†n to√†n kh·ªëi g·ªó n√†y (c√≥ th·ªÉ t√≠ch V = 0.001 m¬≥) v√†o n∆∞·ªõc (c√≥ d = 10000 N/m¬≥).</p>
                <h4>C√¢u h·ªèi: Kh·ªëi g·ªó s·∫Ω ch√¨m hay n·ªïi?</h4>
                <div id="game-controls">
                    <button id="btn-float">N·ªïi</button>
                    <button id="btn-sink">Ch√¨m</button>
                </div>
                <div class="game-animation">
                    <div class="water-surface"></div>
                    <div id="game-object"></div>
                </div>
                <div id="game-feedback" class="feedback"></div>
            </div>
        </section>

        <section id="phan3" class="card">
            <h2>Ph·∫ßn III: Ki·∫øn th·ª©c c·ªët l√µi c·∫ßn nh·ªõ</h2>
            <ul>
                <li><strong>ƒê·ªãnh lu·∫≠t Archimedes:</strong> M·ªôt v·∫≠t nh√∫ng trong ch·∫•t l·ªèng b·ªã ch·∫•t l·ªèng ƒë·∫©y th·∫≥ng ƒë·ª©ng t·ª´ d∆∞·ªõi l√™n tr√™n v·ªõi m·ªôt l·ª±c c√≥ ƒë·ªô l·ªõn b·∫±ng tr·ªçng l∆∞·ª£ng c·ªßa ph·∫ßn ch·∫•t l·ªèng m√† v·∫≠t chi·∫øm ch·ªó.</li>
                <li><strong>C√¥ng th·ª©c t√≠nh L·ª±c ƒë·∫©y Archimedes:</strong> <code>F<sub>A</sub> = d ‚ãÖ V</code>
                    <ul>
                        <li><strong>F<sub>A</sub>:</strong> L·ª±c ƒë·∫©y Archimedes (N).</li>
                        <li><strong>d:</strong> Tr·ªçng l∆∞·ª£ng ri√™ng c·ªßa <strong>ch·∫•t l·ªèng</strong> (N/m¬≥).</li>
                        <li><strong>V:</strong> Th·ªÉ t√≠ch c·ªßa <strong>ph·∫ßn v·∫≠t ch√¨m</strong> trong ch·∫•t l·ªèng (m¬≥).</li>
                    </ul>
                </li>
                <li><strong>ƒêi·ªÅu ki·ªán ch√¨m, n·ªïi c·ªßa v·∫≠t:</strong> (P l√† tr·ªçng l∆∞·ª£ng c·ªßa v·∫≠t)
                    <ul>
                        <li>V·∫≠t <strong>ch√¨m xu·ªëng</strong> khi: <strong>P > F<sub>A</sub></strong></li>
                        <li>V·∫≠t <strong>n·ªïi l√™n</strong> khi: <strong>P < F<sub>A</sub></strong></li>
                        <li>V·∫≠t <strong>l∆° l·ª≠ng</strong> trong ch·∫•t l·ªèng khi: <strong>P = F<sub>A</sub></strong></li>
                    </ul>
                </li>
            </ul>
        </section>

        <section id="ai-chatbot-card" class="card">
            <h3>ü§ñ Tr·ª£ l√Ω AI</h3>
            <p>B·∫°n c√≥ th·∫Øc m·∫Øc g√¨ v·ªÅ L·ª±c ƒë·∫©y Archimedes kh√¥ng?</p>
            <div id="chat-window" class="chat-window"></div>
            <div class="chat-input-area">
                <input type="text" id="user-input" placeholder="V√≠ d·ª•: T·∫°i sao t√†u l√†m b·∫±ng th√©p l·∫°i n·ªïi?">
                <button id="send-button">G·ª≠i</button>
            </div>
        </section>

        <section id="phan4" class="card">
            <h2>Ph·∫ßn IV: Luy·ªán t·∫≠p v√† V·∫≠n d·ª•ng</h2>
            <div class="exercise-item">
                <h4>B√†i 1 (T√≠nh to√°n c∆° b·∫£n):</h4>
                <p>M·ªôt v·∫≠t c√≥ th·ªÉ t√≠ch 0.002 m¬≥ ƒë∆∞·ª£c nh√∫ng ch√¨m ho√†n to√†n trong n∆∞·ªõc (d = 10000 N/m¬≥). T√≠nh ƒë·ªô l·ªõn l·ª±c ƒë·∫©y Archimedes.</p>
                <input type="number" id="ex1-answer" placeholder="ƒê√°p √°n (N)">
                <button onclick="checkEx1()">Ki·ªÉm tra</button>
                <div id="feedback-ex1" class="feedback"></div>
            </div>
            <div class="exercise-item">
                <h4>B√†i 2 (Suy lu·∫≠n):</h4>
                <p>M·ªôt v·∫≠t n·∫∑ng 50 N. Khi treo v√†o l·ª±c k·∫ø v√† nh√∫ng ch√¨m trong n∆∞·ªõc, l·ª±c k·∫ø ch·ªâ 30 N.<br>a) L·ª±c ƒë·∫©y Archimedes t√°c d·ª•ng l√™n v·∫≠t l√† bao nhi√™u?<br>b) Th·ªÉ t√≠ch c·ªßa v·∫≠t l√† bao nhi√™u? (d<sub>n∆∞·ªõc</sub> = 10000 N/m¬≥)</p>
                a) F<sub>A</sub> = <input type="number" id="ex2a-answer" placeholder="N"> 
                b) V = <input type="number" id="ex2b-answer" placeholder="m¬≥" step="0.0001">
                <button onclick="checkEx2()">Ki·ªÉm tra</button>
                <div id="feedback-ex2" class="feedback"></div>
            </div>
            <div class="exercise-item">
                <h4>B√†i 3 (Tr·∫Øc nghi·ªám v·∫≠n d·ª•ng):</h4>
                <p>Hai qu·∫£ c·∫ßu s·∫Øt c√≥ c√πng k√≠ch th∆∞·ªõc ƒë∆∞·ª£c nh√∫ng ch√¨m trong hai c·ªëc: m·ªôt c·ªëc ƒë·ª±ng n∆∞·ªõc, m·ªôt c·ªëc ƒë·ª±ng d·∫ßu h·ªèa. Qu·∫£ c·∫ßu n√†o ch·ªãu l·ª±c ƒë·∫©y Archimedes l·ªõn h∆°n?</p>
                <div><label><input type="radio" name="q-ex3" value="a"> Qu·∫£ c·∫ßu trong d·∫ßu h·ªèa.</label></div>
                <div><label><input type="radio" name="q-ex3" value="b" data-correct="true"> Qu·∫£ c·∫ßu trong n∆∞·ªõc.</label></div>
                <div><label><input type="radio" name="q-ex3" value="c"> Hai l·ª±c ƒë·∫©y b·∫±ng nhau.</label></div>
                <div id="feedback-q-ex3" class="feedback"></div>
            </div>
             <div class="exercise-item">
                <h4>B√†i 4 (ƒê√∫ng/Sai):</h4>
                <p>"M·ªôt v·∫≠t l√†m b·∫±ng g·ªó s·∫Ω lu√¥n n·ªïi trong m·ªçi lo·∫°i ch·∫•t l·ªèng."</p>
                <div><label><input type="radio" name="q-ex4" value="a"> ƒê√∫ng</label></div>
                <div><label><input type="radio" name="q-ex4" value="b" data-correct="true"> Sai</label></div>
                <div id="feedback-q-ex4" class="feedback"></div>
            </div>
        </section>
    </div>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">
                <div><h4>Ngu·ªìn tham kh·∫£o</h4><ul><li>S√°ch gi√°o khoa KHTN 8 - B·ªô s√°ch K·∫øt n·ªëi tri th·ª©c.</li><li>PhET Interactive Simulations.</li></ul></div>
                <div><h4>V·ªÅ trang web</h4><ul><li><a href="/">V·ªÅ trang danh s√°ch h·ªçc li·ªáu</a></li></ul></div>
                <div><h4>B·∫£n quy·ªÅn & Li√™n h·ªá</h4><p>&copy; <span id="copyright-year">nungvanhien</span></p><p>G√≥p √Ω: <a href="mailto:gopy@example.com">vanhien1199@gmail.com</a></p></div>
            </div>
        </div>
    </footer>
    <a href="#page-top" id="back-to-top-btn" title="L√™n ƒë·∫ßu trang">‚¨ÜÔ∏è</a>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- PH·∫¶N II: TR√í CH∆†I "CH√åM HAY N·ªîI?" ---
        const btnFloat = document.getElementById('btn-float');
        const btnSink = document.getElementById('btn-sink');
        const gameObject = document.getElementById('game-object');
        const gameFeedback = document.getElementById('game-feedback');
        
        const P_vat = 8; // N
        const V_vat = 0.001; // m¬≥
        const d_long = 10000; // N/m¬≥
        const FA = d_long * V_vat; // 10 N
        const willFloat = P_vat < FA;

        function playGame(userChoiceIsFloat) {
            btnFloat.disabled = true;
            btnSink.disabled = true;
            
            if (willFloat) {
                gameObject.classList.add('floating');
            } else {
                gameObject.classList.add('sinking');
            }

            if (userChoiceIsFloat === willFloat) {
                gameFeedback.className = 'feedback correct';
                gameFeedback.innerHTML = `Ch√≠nh x√°c! Ta t√≠nh ƒë∆∞·ª£c F<sub>A</sub> = d * V = 10000 * 0.001 = 10 N. <br> V√¨ P (8N) < F<sub>A</sub> (10N) n√™n v·∫≠t s·∫Ω n·ªïi.`;
            } else {
                gameFeedback.className = 'feedback incorrect';
                gameFeedback.innerHTML = `Ch∆∞a ƒë√∫ng! Ta t√≠nh ƒë∆∞·ª£c F<sub>A</sub> = d * V = 10000 * 0.001 = 10 N. <br> V√¨ P (8N) < F<sub>A</sub> (10N) n√™n v·∫≠t ph·∫£i n·ªïi l√™n.`;
            }
        }
        btnFloat.addEventListener('click', () => playGame(true));
        btnSink.addEventListener('click', () => playGame(false));

        // --- PH·∫¶N IV: LUY·ªÜN T·∫¨P ---
        // B√†i 1
        window.checkEx1 = function() {
            const answer = parseFloat(document.getElementById('ex1-answer').value);
            const feedback = document.getElementById('feedback-ex1');
            const correctAnswer = 10000 * 0.002;
            if (answer === correctAnswer) {
                feedback.textContent = `Ch√≠nh x√°c! F‚Çê = d * V = 10000 * 0.002 = 20 N.`;
                feedback.className = 'feedback correct';
            } else {
                feedback.textContent = "Ch∆∞a ƒë√∫ng, h√£y √°p d·ª•ng c√¥ng th·ª©c F‚Çê = d * V.";
                feedback.className = 'feedback incorrect';
            }
        };
        // B√†i 2
        window.checkEx2 = function() {
            const fa_answer = parseFloat(document.getElementById('ex2a-answer').value);
            const v_answer = parseFloat(document.getElementById('ex2b-answer').value);
            const feedback = document.getElementById('feedback-ex2');
            const fa_correct = 50 - 30;
            const v_correct = fa_correct / 10000;

            if (fa_answer === fa_correct && Math.abs(v_answer - v_correct) < 0.0001) {
                feedback.innerHTML = `Tuy·ªát v·ªùi! F‚Çê = P - P' = 50 - 30 = 20 N.<br>V = F‚Çê / d = 20 / 10000 = 0.002 m¬≥.`;
                feedback.className = 'feedback correct';
            } else {
                feedback.textContent = "Ch∆∞a ch√≠nh x√°c. L·ª±c ƒë·∫©y ch√≠nh l√† ƒë·ªô gi·∫£m bi·ªÉu ki·∫øn c·ªßa tr·ªçng l∆∞·ª£ng.";
                feedback.className = 'feedback incorrect';
            }
        };
        // B√†i 3 & 4
        document.querySelectorAll('#practice-quiz input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const name = this.name;
                const feedbackEl = document.getElementById('feedback-' + name);
                let explanation = '';
                if (name === 'q-ex3' && this.dataset.correct) explanation = "ƒê√∫ng! V√¨ th·ªÉ t√≠ch chi·∫øm ch·ªó nh∆∞ nhau nh∆∞ng tr·ªçng l∆∞·ª£ng ri√™ng c·ªßa n∆∞·ªõc l·ªõn h∆°n d·∫ßu h·ªèa.";
                if (name === 'q-ex4' && this.dataset.correct) explanation = "ƒê√∫ng! G·ªó s·∫Ω ch√¨m trong th·ªßy ng√¢n v√¨ tr·ªçng l∆∞·ª£ng ri√™ng c·ªßa g·ªó nh·ªè h∆°n th·ªßy ng√¢n.";
                
                if (this.dataset.correct) {
                    feedbackEl.textContent = explanation || "Ch√≠nh x√°c!";
                    feedbackEl.className = 'feedback correct';
                } else {
                    feedbackEl.textContent = "Ch∆∞a ƒë√∫ng, h√£y suy nghƒ© l·∫°i.";
                    feedbackEl.className = 'feedback incorrect';
                }
            });
        });

        // --- FOOTER & BACK-TO-TOP ---
        const backToTopBtn = document.getElementById("back-to-top-btn");
        if(backToTopBtn){ window.onscroll = function() { if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) { backToTopBtn.style.display = "block"; } else { backToTopBtn.style.display = "none"; } }; }
        const yearSpan = document.getElementById('copyright-year');
        if (yearSpan) { yearSpan.textContent = new Date().getFullYear(); }
    });
    </script>
</body>
</html>