<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i 15: √Åp su·∫•t tr√™n m·ªôt b·ªÅ m·∫∑t</title>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <script>
        window.lessonId = 'ap-suat';
        document.addEventListener('DOMContentLoaded', () => {
            const chatWindow = document.getElementById('chat-window');
            const userInput = document.getElementById('user-input');
            const sendButton = document.getElementById('send-button');
            const AI_SERVICE_URL = 'https://ai-trung-tam-service.onrender.com';
            const LESSON_ID = window.lessonId || 'default';

            if(sendButton){
                sendButton.addEventListener('click', askAI);
                userInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') askAI(); });
            }

            function addMessageToChat(text, className) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('chat-message', className);
                chatWindow.appendChild(messageElement);
                messageElement.innerHTML = marked.parse(text);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                return messageElement;
            }

            async function askAI() {
                const question = userInput.value.trim();
                if (!question) return;
                addMessageToChat(question, 'user-message');
                userInput.value = '';
                const waitingMessage = addMessageToChat('Tr·ª£ l√Ω AI ƒëang suy nghƒ©...', 'ai-message');
                try {
                    const response = await fetch(`${AI_SERVICE_URL}/ask`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ question: question, lesson_id: LESSON_ID })
                    });
                    if (!response.ok) throw new Error('L·ªói m·∫°ng ho·∫∑c server');
                    const data = await response.json();
                    waitingMessage.innerHTML = marked.parse(data.answer);
                } catch (error) {
                    waitingMessage.innerHTML = marked.parse('**Xin l·ªói, ƒë√£ c√≥ l·ªói x·∫£y ra!**');
                }
            }
        });
    </script>

    <style>
        :root {
            --primary-color: #bf360c; /* Cam ƒë·∫≠m */
            --secondary-color: #01579b; /* Xanh d∆∞∆°ng ƒë·∫≠m */
            --bg-color: #fbe9e7;
            --card-bg-color: #ffffff;
            --text-color: #333;
            --correct-color: #4caf50;
            --incorrect-color: #f44336;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.7; background-color: var(--bg-color); color: var(--text-color); margin: 0; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        header { background-color: var(--primary-color); color: white; padding: 1.5rem 1rem; text-align: center; margin-bottom: 30px; position: relative; }
        header h1 { margin: 0; font-size: 2.5em; }
        .card { background-color: var(--card-bg-color); border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); padding: 30px; margin-bottom: 30px; }
        h2, h3, h4 { color: var(--primary-color); }
        h2 { border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px; margin-top: 0; }
        button { background-color: var(--secondary-color); color: white; border: none; padding: 12px 22px; font-size: 1em; border-radius: 5px; cursor: pointer; transition: all 0.3s ease; }
        button:hover { background-color: #0277bd; }
        input[type="number"] { padding: 8px; border-radius: 5px; border: 1px solid #ccc; margin: 0 5px; }
        
        .home-btn { position: absolute; top: 50%; left: 20px; transform: translateY(-50%); font-size: 28px; color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s, transform 0.3s; }
        .home-btn:hover { opacity: 1; transform: translateY(-50%) scale(1.1); }
        
        /* Ph·∫ßn I: M√¥ ph·ªèng √Åp su·∫•t */
        .pressure-sim-layout { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        .sim-display { position: relative; height: 300px; background-color: #fff8e1; border-radius: 5px; border: 1px solid #ddd; }
        .sand-surface { position: absolute; bottom: 0; left: 0; width: 100%; height: 50%; background-color: #ffe0b2; }
        #sim-box { position: absolute; background-color: #a1887f; border: 2px solid #5d4037; transition: bottom 0.5s ease, width 0.3s ease, height 0.3s ease; }
        .sim-controls button.active { background-color: var(--primary-color); color: white; }
        .sim-data { background-color: #f1f1f1; padding: 15px; border-radius: 5px; margin-top: 15px; }
        .sim-data p { margin: 5px 0; font-weight: bold; }

        /* Ph·∫ßn II: K√©o-Th·∫£ */
        .dnd-layout { display: flex; gap: 20px; justify-content: space-between; }
        .dnd-source, .dnd-target { border: 2px dashed #ccc; padding: 15px; border-radius: 8px; width: 48%; }
        .dnd-source h4 { margin-top: 0; }
        .dnd-target h4 { margin-top: 0; text-align: center; }
        .draggable-item { background-color: #e0e0e0; padding: 8px 12px; margin: 8px 0; border-radius: 5px; cursor: grab; }
        .dnd-target.over { background-color: #e8f5e9; }
        .dnd-target#increase-pressure { border-color: var(--incorrect-color); }
        .dnd-target#decrease-pressure { border-color: var(--correct-color); }

        /* Ph·∫ßn IV: Luy·ªán t·∫≠p */
        .feedback { margin-top: 10px; font-weight: bold; }
        .feedback.correct { color: var(--correct-color); }
        .feedback.incorrect { color: var(--incorrect-color); }

        /* CSS Chatbot, Footer, Back-to-Top */
        .chat-window { height: 300px; border: 1px solid #ccc; padding: 10px; overflow-y: auto; margin-bottom: 10px; border-radius: 5px; }
        .chat-message { margin-bottom: 10px; } .user-message { text-align: right; }
        .ai-message { background-color: #f1f1f1; padding: 10px; border-radius: 8px; display: inline-block; max-width: 90%; text-align: left; }
        .chat-input-area { display: flex; gap: 10px; } .chat-input-area input { flex-grow: 1; }
        .site-footer { background-color: #333; color: #f1f1f1; padding: 30px 0; font-size: 0.9em; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .site-footer h4 { color: var(--secondary-color); } .site-footer ul { list-style-type: none; padding: 0; }
        .site-footer a { color: #f1f1f1; text-decoration: none; } .site-footer a:hover { color: var(--secondary-color); }
        #back-to-top-btn { display: none; position: fixed; bottom: 20px; right: 20px; z-index: 99; background-color: var(--secondary-color); color: white; cursor: pointer; padding: 10px; border-radius: 50%; font-size: 18px; width: 50px; height: 50px; text-align: center; line-height: 30px; text-decoration: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2); border: none;}
        #back-to-top-btn:hover { background-color: var(--primary-color); }
        
        @media (max-width: 768px) { .pressure-sim-layout, .dnd-layout { grid-template-columns: 1fr; flex-direction: column; } }
    </style>
</head>
<body id="page-top">
    <header>
        <a href="/" class="home-btn" title="V·ªÅ trang ch·ªß">üè†</a>
        <h1>B√†i 15: √ÅP SU·∫§T TR√äN M·ªòT B·ªÄ M·∫∂T</h1>
    </header>

    <div class="container">
        <section id="phan1" class="card">
            <h2>Ph·∫ßn I: M√¥ ph·ªèng t∆∞∆°ng t√°c "Th√≠ nghi·ªám √Åp su·∫•t"</h2>
            <div class="pressure-sim-layout">
                <div class="sim-display">
                    <div class="sand-surface"></div>
                    <div id="sim-box"></div>
                </div>
                <div class="sim-controls">
                    <h4>B·∫£ng ƒëi·ªÅu khi·ªÉn</h4>
                    <p><strong>1. Thay ƒë·ªïi √Åp l·ª±c (F):</strong></p>
                    <div id="force-controls">
                        <button data-force="10" class="active">1 Kh·ªëi (10 N)</button>
                        <button data-force="20">2 Kh·ªëi (20 N)</button>
                        <button data-force="30">3 Kh·ªëi (30 N)</button>
                    </div>
                    <p><strong>2. Thay ƒë·ªïi Di·ªán t√≠ch b·ªã √©p (S):</strong></p>
                    <div id="area-controls">
                        <button data-area="0.1" data-w="150" data-h="50">N·∫±m ngang (0.1 m¬≤)</button>
                        <button data-area="0.05" data-w="100" data-h="75">N·∫±m nghi√™ng</button>
                        <button data-area="0.02" data-w="50" data-h="100" class="active">ƒê·ª©ng th·∫≥ng (0.02 m¬≤)</button>
                    </div>
                    <div class="sim-data">
                        <h4>S·ªë li·ªáu th·ªùi gian th·ª±c:</h4>
                        <p>√Åp l·ª±c F: <span id="display-f"></span> N</p>
                        <p>Di·ªán t√≠ch S: <span id="display-s"></span> m¬≤</p>
                        <p>√Åp su·∫•t p: <span id="display-p"></span> Pa</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="phan2" class="card">
            <h2>Ph·∫ßn II: ·ª®ng d·ª•ng th·ª±c t·∫ø (K√©o-Th·∫£)</h2>
            <p>H√£y k√©o c√°c v·∫≠t d·ª•ng sau v√†o ƒë√∫ng c·ªôt ƒë·ªÉ xem ch√∫ng l√† ·ª©ng d·ª•ng l√†m tƒÉng hay gi·∫£m √°p su·∫•t.</p>
            <div class="dnd-layout">
                <div class="dnd-source">
                    <h4>V·∫≠t d·ª•ng</h4>
                    <div class="draggable-item" draggable="true" data-target="increase">L∆∞·ª°i dao</div>
                    <div class="draggable-item" draggable="true" data-target="decrease">M√≥ng nh√†</div>
                    <div class="draggable-item" draggable="true" data-target="increase">ƒê·∫ßu ƒëinh</div>
                    <div class="draggable-item" draggable="true" data-target="decrease">B√°nh xe tƒÉng</div>
                    <div class="draggable-item" draggable="true" data-target="decrease">V√°n tr∆∞·ª£t tuy·∫øt</div>
                </div>
                <div class="dnd-target" id="increase-pressure"><h4>L√†m TƒÇNG √°p su·∫•t</h4></div>
                <div class="dnd-target" id="decrease-pressure"><h4>L√†m GI·∫¢M √°p su·∫•t</h4></div>
            </div>
        </section>
        
        <section id="phan3" class="card">
            <h2>Ph·∫ßn III: Ki·∫øn th·ª©c c·ªët l√µi c·∫ßn nh·ªõ</h2>
            <ul>
                <li><strong>√Åp l·ª±c</strong> l√† l·ª±c √©p c√≥ ph∆∞∆°ng vu√¥ng g√≥c v·ªõi m·∫∑t b·ªã √©p.</li>
                <li><strong>√Åp su·∫•t (p)</strong> l√† ƒë·ªô l·ªõn c·ªßa √°p l·ª±c tr√™n m·ªôt ƒë∆°n v·ªã di·ªán t√≠ch b·ªã √©p.</li>
                <li><strong>C√¥ng th·ª©c t√≠nh √°p su·∫•t:</strong> p = F/S
                    <ul>
                        <li><strong>p:</strong> √°p su·∫•t, ƒë∆°n v·ªã Pascal (Pa). 1 Pa = 1 N/m¬≤.</li>
                        <li><strong>F:</strong> √°p l·ª±c, ƒë∆°n v·ªã Newton (N).</li>
                        <li><strong>S:</strong> di·ªán t√≠ch b·ªã √©p, ƒë∆°n v·ªã m√©t vu√¥ng (m¬≤).</li>
                    </ul>
                </li>
                <li>ƒê·ªÉ <strong>tƒÉng √°p su·∫•t</strong>, ta c√≥ th·ªÉ: <strong>TƒÉng √°p l·ª±c (F)</strong> ho·∫∑c <strong>Gi·∫£m di·ªán t√≠ch b·ªã √©p (S)</strong>.</li>
                <li>ƒê·ªÉ <strong>gi·∫£m √°p su·∫•t</strong>, ta c√≥ th·ªÉ: <strong>Gi·∫£m √°p l·ª±c (F)</strong> ho·∫∑c <strong>TƒÉng di·ªán t√≠ch b·ªã √©p (S)</strong>.</li>
            </ul>
        </section>

        <section id="ai-chatbot-card" class="card">
            <h3>ü§ñ Tr·ª£ l√Ω AI</h3>
            <p>B·∫°n c√≥ th·∫Øc m·∫Øc g√¨ v·ªÅ √°p su·∫•t kh√¥ng? H√£y h·ªèi t√¥i nh√©!</p>
            <div id="chat-window" class="chat-window">
                <div class="chat-message ai-message">Ch√†o b·∫°n! H√£y ƒë·∫∑t c√¢u h·ªèi v·ªÅ b√†i h·ªçc n√†y.</div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="user-input" placeholder="V√≠ d·ª•: T·∫°i sao xe tƒÉng d√πng x√≠ch?">
                <button id="send-button">G·ª≠i</button>
            </div>
        </section>

        <section id="phan4" class="card">
            <h2>Ph·∫ßn IV: Luy·ªán t·∫≠p</h2>
            <h4>1. B√†i t·∫≠p t√≠nh to√°n</h4>
            <p>M·ªôt chi·∫øc t·ªß c√≥ tr·ªçng l∆∞·ª£ng 1200 N, di·ªán t√≠ch m·∫∑t ƒë√°y ti·∫øp x√∫c v·ªõi s√†n l√† 0.5 m¬≤. T√≠nh √°p su·∫•t c·ªßa t·ªß t√°c d·ª•ng l√™n s√†n nh√†.</p>
            <div>
                <input type="number" id="calc-answer" placeholder="Nh·∫≠p ƒë√°p √°n (Pa)">
                <button onclick="checkPressureCalc()">Ki·ªÉm tra</button>
            </div>
            <div id="feedback-calc" class="feedback"></div>

            <hr style="margin: 30px 0;">
            <h4>2. B√†i t·∫≠p tr·∫Øc nghi·ªám</h4>
            <p>T·∫°i sao m≈©i kim, m≈©i ƒëinh l·∫°i ƒë∆∞·ª£c l√†m r·∫•t nh·ªçn?</p>
            <div id="feedback-mcq" class="feedback"></div>
            <div><label><input type="radio" name="q-mcq" value="a"> ƒê·ªÉ tƒÉng √°p l·ª±c t√°c d·ª•ng.</label></div>
            <div><label><input type="radio" name="q-mcq" value="b" data-correct="true"> ƒê·ªÉ gi·∫£m di·ªán t√≠ch b·ªã √©p, t·ª´ ƒë√≥ tƒÉng √°p su·∫•t.</label></div>
            <div><label><input type="radio" name="q-mcq" value="c"> ƒê·ªÉ v·∫≠t li·ªáu ƒë∆∞·ª£c b·ªÅn h∆°n.</label></div>
        </section>
    </div>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">
                <div><h4>Ngu·ªìn tham kh·∫£o</h4><ul><li>S√°ch gi√°o khoa KHTN 8 - B·ªô s√°ch K·∫øt n·ªëi tri th·ª©c.</li></ul></div>
                <div><h4>V·ªÅ trang web</h4><ul><li><a href="/">V·ªÅ trang danh s√°ch h·ªçc li·ªáu</a></li></ul></div>
                <div><h4>B·∫£n quy·ªÅn & Li√™n h·ªá</h4><p>&copy; <span id="copyright-year"></span> - nungvanhien</p><p>G√≥p √Ω: <a href="mailto:gopy@example.com">vanhien1199@gmail.com</a></p></div>
            </div>
        </div>
    </footer>
    <a href="#page-top" id="back-to-top-btn" title="L√™n ƒë·∫ßu trang">‚¨ÜÔ∏è</a>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- PH·∫¶N I: M√î PH·ªéNG √ÅP SU·∫§T ---
        const simBox = document.getElementById('sim-box');
        const displayF = document.getElementById('display-f');
        const displayS = document.getElementById('display-s');
        const displayP = document.getElementById('display-p');
        const forceControls = document.getElementById('force-controls');
        const areaControls = document.getElementById('area-controls');
        
        let simState = { force: 10, area: 0.02, width: 50, height: 100 };

        function updateSimulation() {
            const pressure = simState.force / simState.area;
            const sinkDepth = Math.min(pressure * 0.2, 100); // T·ªâ l·ªá l√∫n v√† gi·ªõi h·∫°n l√∫n

            // C·∫≠p nh·∫≠t hi·ªÉn th·ªã s·ªë li·ªáu
            displayF.textContent = simState.force;
            displayS.textContent = simState.area;
            displayP.textContent = pressure.toFixed(0);
            
            // C·∫≠p nh·∫≠t h√¨nh ·∫£nh m√¥ ph·ªèng
            simBox.style.width = `${simState.width}px`;
            simBox.style.height = `${simState.height}px`;
            simBox.style.left = `calc(50% - ${simState.width/2}px)`;
            simBox.style.bottom = `${150 - sinkDepth}px`; // 150 l√† chi·ªÅu cao l·ªõp c√°t
        }

        forceControls.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') {
                simState.force = parseFloat(e.target.dataset.force);
                forceControls.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                updateSimulation();
            }
        });
        areaControls.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') {
                simState.area = parseFloat(e.target.dataset.area);
                simState.width = parseFloat(e.target.dataset.w);
                simState.height = parseFloat(e.target.dataset.h);
                areaControls.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                updateSimulation();
            }
        });
        updateSimulation(); // Ch·∫°y l·∫ßn ƒë·∫ßu

        // --- PH·∫¶N II: K√âO-TH·∫¢ ---
        const draggables = document.querySelectorAll('.draggable-item');
        const dropTargets = document.querySelectorAll('.dnd-target');
        draggables.forEach(item => {
            item.addEventListener('dragstart', e => { e.dataTransfer.setData('text/plain', e.target.dataset.target); });
        });
        dropTargets.forEach(zone => {
            zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('over'); });
            zone.addEventListener('dragleave', () => zone.classList.remove('over'));
            zone.addEventListener('drop', e => {
                e.preventDefault();
                zone.classList.remove('over');
                const targetType = e.dataTransfer.getData('text/plain');
                if (zone.id.includes(targetType)) {
                    const droppedItem = document.querySelector(`.draggable-item[data-target="${targetType}"]`);
                    zone.appendChild(droppedItem);
                }
            });
        });

        // --- PH·∫¶N IV: LUY·ªÜN T·∫¨P ---
        window.checkPressureCalc = function() {
            const userAnswer = parseFloat(document.getElementById('calc-answer').value);
            const feedbackEl = document.getElementById('feedback-calc');
            const correctAnswer = 1200 / 0.5;
            if (userAnswer === correctAnswer) {
                feedbackEl.textContent = `Ch√≠nh x√°c! p = F/S = 1200 / 0.5 = 2400 (Pa).`;
                feedbackEl.className = 'feedback correct';
            } else {
                feedbackEl.textContent = "Ch∆∞a ƒë√∫ng, h√£y t√≠nh l·∫°i nh√©!";
                feedbackEl.className = 'feedback incorrect';
            }
        };

        const mcqRadios = document.querySelectorAll('input[name="q-mcq"]');
        mcqRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                const feedbackEl = document.getElementById('feedback-mcq');
                if (this.dataset.correct) {
                    feedbackEl.textContent = "ƒê√∫ng r·ªìi! M≈©i ƒëinh nh·ªçn ƒë·ªÉ gi·∫£m di·ªán t√≠ch, tƒÉng √°p su·∫•t.";
                    feedbackEl.className = 'feedback correct';
                } else {
                    feedbackEl.textContent = "Ch∆∞a ch√≠nh x√°c. H√£y nghƒ© xem vi·ªác l√†m nh·ªçn s·∫Ω ·∫£nh h∆∞·ªüng ƒë·∫øn F hay S?";
                    feedbackEl.className = 'feedback incorrect';
                }
            });
        });

        // --- FOOTER & BACK-TO-TOP ---
        const backToTopBtn = document.getElementById("back-to-top-btn");
        if(backToTopBtn){ window.onscroll = function() { if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) { backToTopBtn.style.display = "block"; } else { backToTopBtn.style.display = "none"; } }; }
        const yearSpan = document.getElementById('copyright-year');
        if (yearSpan) { yearSpan.textContent = new Date().getFullYear(); }
    });
    </script>
</body>

</html>
